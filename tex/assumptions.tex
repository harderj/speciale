
\subsection{Assumption 1: Hölder Smoothness} %todo spell Holder properly

\begin{defn}[Hölder smoothness]
  For $f : \Cal{S} \to \R$ we define
  \begin{equation}
    \norm{f}_{C_r} \defeq 
    \sum_{|{\alpha}| < \beta}
    \norm{\partial^{\alpha}f}_\infty +
    \sum_{\norm{{\alpha}}_1 = \floor{\beta}}
    \sup_{x \neq y} \frac{|\partial^\alpha (f(x) - f(y))|}
  {\norm{x-y}_\infty^{\beta-\floor{\beta}}}
  \end{equation}
  Where $\alpha = (\alpha_1, \dots, \alpha_r) \in \N_0^r$.
  And $\partial^k$ is the partial derivative w.r.t. the $k$th variable.
  If $\norm{f}_{C_r} < \infty$ then $f$ is \defemph{Hölder smooth}.
  Given a compact subset $\Cal{D} \subseteq \R^r$
  the space of Hölder smooth functions on $\Cal{D}$ with norm bounded by
  $H > 0$ is denoted
  \[ C_r(\Cal{D}, \beta, H) \defeq
  \left\{ f : \Cal{D} \to \R \Mid \norm{f}_{C_r} \leq H \right\} \]
\end{defn}

\begin{defn}
  Let $t_j, p_j \in \N$, $t_j\leq p_j$ and $H_j, \beta_j > 0$ for $j \in [q]$.
  We say that $f$ is a \defemph{composition of Hölder smooth functions} when
  \[ f = g_q \circ \dots \circ g_1 \]
  for some functions $g_j : [a_j, b_j]^{p_j} \to [a_{j+1}, b_{j+1}]^{p_{j+1}}$
  that only depend on $t_j$ of their inputs
  for each of their components $g_{jk}$,
  and satisfies $g_{jk} \in C_{t_j}([a_j, b_j]^t_j, \beta_j, H_j)$, 
  i.e. they are Holder smooth.
  We denote the class of these functions
  \[ \Cal{G}(\{p_j, t_j, \beta_j, H_j\}_{j \in [q]}) \]
\end{defn}

\begin{defn}
  Define
  \[ \Cal{F}_0 = \left\{ f : \Cal{S} \times \Cal{A} \to \R \Mid
  f(\cdot, a) \in \Cal{F}(s, V) \; \forall a \in \Cal{A} \right\} \]
  and
  \[ \Cal{G}_0 = \left\{ f : \Cal{S} \times \Cal{A} \to \R
      \Mid f(\cdot, a) = \Cal{G}(\{p_j, t_j, \beta_t, H_j\}_{j \in [q]})
  \; \forall a \in \Cal{A} \right\} \]
\end{defn}

\begin{asm}\label{asm:A1}
  $ T \Cal{F}_0 \subseteq \Cal{G}_0$.
  I.e. t is assumed that $T f \in \Cal{G}_0$ for any $f \in \Cal{F}_0$, 
  so when using the Bellman optimality operator on our sparse ReLU networks,
  we should stay in the class of compositions of Holder smooth functions.
\end{asm}

If also $\Cal{G_0}$ is well approximated by functions in $\Cal{F}_0$
then this assumption implies that $\Cal{F}_0$ is approximately closed
under the Bellman operator $T$ and thus that $Q^*$ is close to $\Cal{F}_0$.

We now look at a case where $\Cal{D}=[0,1]^r$, $q=1$ 
and both the expected reward function and transition kernel
is Hölder smooth.

\begin{prop}
  Assume for all $a \in \Cal{A}$ that
  $P(s,a)$ and $R(s,a)$ are absolutely continuous w.r.t. $\lambda^k$
  and for all $s' \in \Cal{S}$ that
  $s \mapsto P\left(s' \Mid s, a \right)$
  and $s \mapsto \E R(s, a)$
  are both in $C_r([0,1]^r, \beta, H)$.
  Then $T \Cal{F}_0 \subseteq C_r([0,1]^r, \beta, (1 + \gamma V_{\max}) H)$.
\end{prop}
\begin{proof}
  Let $f \in \Cal{F}_0$ and $\alpha \in \N_0^r$.
  Observe that
  \begin{align*}
    \partial^\alpha (Tf)(s, a)
    = & \; \partial^\alpha_s \left( \E R(s, a) \right)
    + \gamma \int_{\Cal{S}}\partial^\alpha_s \left[ \max_{a' \in \Cal{A}}
    f(s', a') P\left(s' \Mid s, a\right) \right] \difd s' 
    \\ \leq & \; \partial^\alpha_s \left( \E R(s, a) \right)
    + \gamma V_{\max} \sup_{s' \in \Cal{S}} \partial_s^\alpha
    P\left(s' \Mid s, a\right)
  \end{align*}
  similarly
  \begin{align*}
    \partial^\alpha (Tf)(s, a) - \partial^\alpha (Tf)(s', a)
    \leq & \; \partial^\alpha_s \left( \E R(s, a) \right)
    - \partial^\alpha_s \left( \E R(s', a) \right)
    \\ & \; + \gamma V_{\max} \sup_{s'' \in \Cal{S}}
    \left( \partial_s^\alpha P(s'' \Mid s, a)
    - \partial_s^\alpha P(s'' \Mid s', a) \right)
  \end{align*}
  Thus
  \begin{align*}
    \norm{Tf}_{C_r} \leq & \; \sum_{\abs{\alpha}<\beta} \left(
      \norm{\partial^\alpha \E R(\cdot, a)}_\infty
      + \gamma V_{\max} \sup_{s \in \Cal{S}} \norm{\partial^\alpha
    P(s \mid \cdot, a)}_\infty \right)
    \\ + & \; \sum_{\norm{\alpha}_1 = \floor{\beta}} \sup_{x \neq y}
    \left(
      \frac{\abs{\partial^\alpha (\E R(x, a) - \E R(y, a))}}
      {\norm{x - y}_{\infty}^{\beta - \floor{\beta}}}
      + \gamma V_{\max} \sup_{s \in \Cal{S}} \frac{
      \abs{\partial^\alpha (\E P(s \mid x, a) - \E R(s \mid y, a))}}
      {\norm{x - y}_{\infty}^{\beta - \floor{\beta}}}
    \right)
    \\ \leq & \; H + \gamma V_{\max} H = (1 + \gamma V_{\max}) H
  \end{align*}
  
\end{proof}


\subsection{Assumption 2: Concentration Coefficients}

\begin{defn}[Concentration coefficients] \label{defn:ccoefs}
  Let $\nu_1, \nu_2 \in \Cal{P}(\Cal{S}\times \Cal{A})$ be probability measures,
  absolutely continuous w.r.t. $m_{\lambda}$
  Define
  \[ \kappa(m, \nu_1, \nu_2) = \sup_{\pi_1, \dots, \pi_m}
    \left[ \E_{v_2} \left( \frac{\mathrm{d} (P^{\pi_m} \dots P^{\pi_1} \nu_1)}
  {\mathrm{d} \nu_2} \right)^2 \right]^{1/2} \]
\end{defn}

\begin{asm}\label{asm:A2}
  Let $\nu$ be the sampling distribution from the algorithm, and $\mu$ the distribution
  over which we measure the error in the main theorem, then we assume
  \[ (1 - \gamma)^2 \sum_{m\geq 1} \gamma^{m-1} m \kappa(m, \mu, \nu)
  = \phi_{\mu, \nu} < \infty \]
\end{asm}


